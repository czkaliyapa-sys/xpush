"use strict";(self.webpackChunkitsxtrapush=self.webpackChunkitsxtrapush||[]).push([[382],{31949(e,i,o){o.d(i,{A:()=>n});const t=new class{constructor(){this.modelMappings={"macbook pro m4":{folder:"macbook_pro_m3_16_inch_2024",files:["scene.gltf"],scale:.12,position:[0,-.5,0],rotation:[0,0,0]},"macbook m4":{folder:"macbook_pro_m3_16_inch_2024",files:["scene.gltf"],scale:.12,position:[0,-.5,0]},"macbook pro 2021":{folder:"2021_macbook_pro_16_m1_pro__m1_max",files:["scene.gltf"],scale:.12,position:[0,-.5,0]},"macbook 2021":{folder:"2021_macbook_pro_16_m1_pro__m1_max",files:["scene.gltf"],scale:.12,position:[0,-.5,0]},"2021 macbook pro 16":{folder:"2021_macbook_pro_16_m1_pro__m1_max",files:["scene.gltf"],scale:.12,position:[0,-.5,0]},"iphone 17 pro":{folder:"iphone-17-pro",files:["source/iphone 17_4.glb"],scale:.1,position:[0,0,0]},"iphone 17 pro max":{folder:"iphone_17_pro_max_model",files:["scene.gltf"],scale:.1,position:[0,0,0]},"apple iphone 17 pro max":{folder:"iphone_17_pro_max_model",files:["scene.gltf"],scale:.1,position:[0,0,0]},"iphone 16 pro max":{folder:"iphone_16_pro_max",files:["scene.gltf"],scale:.1,position:[0,0,0]},"iphone 16 pro":{folder:"iphone_16_pro_max",files:["scene.gltf"],scale:.1,position:[0,0,0]},"iphone 16":{folder:"iphone-16-free",files:["source/1b338ec19f15ad72904b/1b338ec19f15ad72904b.gltf"],scale:.1,position:[0,0,0],rotation:[0,0,0]},"iphone 17":{folder:"iphone-16-free",files:["source/1b338ec19f15ad72904b (1)/1b338ec19f15ad72904b (1).gltf"],scale:.1,position:[0,0,0],rotation:[0,0,0]},"apple iphone 17":{folder:"iphone-16-free",files:["source/1b338ec19f15ad72904b (1)/1b338ec19f15ad72904b (1).gltf"],scale:.1,position:[0,0,0],rotation:[0,0,0]},"iphone 15 pro max":{folder:"iphone_15_pro_max",files:["scene.gltf"],scale:.1,position:[0,0,0]},"apple iphone 15 pro max":{folder:"iphone_15_pro_max",files:["scene.gltf"],scale:.1,position:[0,0,0]},"iphone 15":{folder:"iphone_15",files:["scene.gltf"],scale:.1,position:[0,0,0]},"apple iphone 15":{folder:"iphone_15",files:["scene.gltf"],scale:.1,position:[0,0,0]},"iphone 14 pro":{folder:"iphone-14-pro",files:["source/model.zip"],scale:.1,position:[0,0,0],needsConversion:!0},"iphone 14 pro max":{folder:"iphone_14_pro_max",files:["scene.gltf"],scale:.1,position:[0,0,0]},"apple iphone 14 pro max":{folder:"iphone_14_pro_max",files:["scene.gltf"],scale:.1,position:[0,0,0]},"iphone 14":{folder:"iphone_14",files:["scene.gltf"],scale:.1,position:[0,0,0]},"apple iphone 14":{folder:"iphone_14",files:["scene.gltf"],scale:.1,position:[0,0,0]},"iphone 13 pro max":{folder:"apple_iphone_13_pro_max",files:["scene.gltf"],scale:.1,position:[0,0,0],rotation:[0,0,0]},"iphone 13":{folder:"iphone_13_concept",files:["scene.gltf"],scale:.05,position:[0,0,0]},"apple iphone 13":{folder:"iphone_13_concept",files:["scene.gltf"],scale:.05,position:[0,0,0]},"samsung galaxy s25":{folder:"samsung-s25-ultra-free",files:["source/samsung_s24_ultra.glb"],scale:.1,position:[0,0,0]},"samsung s25 ultra":{folder:"samsung-s25-ultra-free",files:["source/samsung_s24_ultra.glb"],scale:.1,position:[0,0,0]},"samsung s25":{folder:"samsung-s25",files:["source/SAMSUNG S25/SAMSUNG S25.gltf"],scale:.1,position:[0,0,0]},"samsung galaxy a14":{folder:"SAMSUNG Galaxy A14 5G",files:["SAMSUNG Galaxy A14 5G/GLTF/GLTF/SAMSUNG Galaxy A14 5G.gltf"],scale:.81,position:[0,0,0]},"galaxy a14":{folder:"SAMSUNG Galaxy A14 5G",files:["SAMSUNG Galaxy A14 5G/GLTF/GLTF/SAMSUNG Galaxy A14 5G.gltf"],scale:.81,position:[0,0,0]},"samsung galaxy s23 ultra":{folder:"samsung-s25-ultra-free",files:["source/samsung_s24_ultra.glb"],scale:.1,position:[0,0,0]},"s23 ultra":{folder:"samsung-s25-ultra-free",files:["source/samsung_s24_ultra.glb"],scale:.1,position:[0,0,0]},"samsung s24":{folder:"samsung-s25",files:["source/SAMSUNG S25/SAMSUNG S25.gltf"],scale:.1,position:[0,0,0]},"asus tuf gaming":{folder:"asus_rog_strix_scar_17_2023_g733_gaming_laptop",files:["scene.gltf"],scale:.12,position:[0,-.5,0]},"asus tuf f15":{folder:"asus_rog_strix_scar_17_2023_g733_gaming_laptop",files:["scene.gltf"],scale:.12,position:[0,-.5,0]},"asus rog strix":{folder:"asus_rog_strix_scar_17_2023_g733_gaming_laptop",files:["scene.gltf"],scale:.12,position:[0,-.5,0]},"hp omen":{folder:"hp_omen_laptop",files:["scene.gltf","e.bin"],scale:1,position:[0,-.5,0]},"hp 14s":{folder:"hp_14s-dq2622tu_laptop",files:["scene.gltf"],scale:1,position:[0,-.5,0]},"hp laptop 14s":{folder:"hp_14s-dq2622tu_laptop",files:["scene.gltf"],scale:1,position:[0,-.5,0]},"lenovo ideapad":{folder:"lenovo_ideapad",files:["scene.gltf"],scale:1,position:[0,-.5,0],rotation:[0,0,0]},lenovo:{folder:"lenovo",files:["source/two283.fbx"],scale:1,position:[0,-.5,0]},"acer nitro 5":{folder:"acer-nitro-5-laptop",files:["source/Acer Nitro 5 AN515-57.glb"],scale:.25,position:[0,-.5,0]},"msi monitor 27":{folder:"msi_optix_mag271cr_27",files:["scene.gltf"],scale:1,position:[0,-.5,0]},"msi optix mag271cr 27":{folder:"msi_optix_mag271cr_27",files:["scene.gltf"],scale:1,position:[0,-.5,0]},"nvidia rtx 2070":{folder:"geforce_rtx_2070_founders_edition",files:["scene.gltf"],scale:1,position:[0,-.5,0]},"geforce rtx 2070":{folder:"geforce_rtx_2070_founders_edition",files:["scene.gltf"],scale:1,position:[0,-.5,0]},"nvidea rtx 2070":{folder:"geforce_rtx_2070_founders_edition",files:["scene.gltf"],scale:1,position:[0,-.5,0]},"nvidia rtx 3060":{folder:"geforce_rtx_3060_ti_founders_edition",files:["scene.gltf"],scale:1,position:[0,-.5,0]},"geforce rtx 3060":{folder:"geforce_rtx_3060_ti_founders_edition",files:["scene.gltf"],scale:1,position:[0,-.5,0]},"nvidea rtx 3060":{folder:"geforce_rtx_3060_ti_founders_edition",files:["scene.gltf"],scale:1,position:[0,-.5,0]},"redmi note 14":{folder:"redmi_note_14__realistic_smartphone_3d_model",files:["scene.gltf"],scale:.1,position:[0,0,0]},"vivo x80":{folder:"vivo-x80",files:["source/vivo_x80without_extra_textures.glb"],scale:.1,position:[0,0,0]},"nintendo switch":{folder:"nintendo_switch",files:["scene.gltf"],scale:1,position:[0,-.5,0]},ps5:{folder:"ps5",files:["scene.gltf"],scale:1,position:[0,-.5,0]},"dual shock 5":{folder:"playstation_5_dualsense",files:["scene.gltf"],scale:1,position:[0,-.5,0]},"xbox controller":{folder:"xbox_controller",files:["scene.gltf"],scale:1,position:[0,-.5,0]},"xbox series x":{folder:"xbox_one_s",files:["scene.gltf"],scale:1,position:[0,-.5,0]},"dualshock 5":{folder:"playstation_5_dualsense",files:["scene.gltf"],scale:1,position:[0,-.5,0]},"dualshock 5 sony":{folder:"playstation_5_dualsense",files:["scene.gltf"],scale:1,position:[0,-.5,0]},"dualshock 4 sony":{folder:"game_controller-_version_1",files:["scene.gltf"],scale:1,position:[0,-.5,0]},"dualshock 4":{folder:"game_controller-_version_1",files:["scene.gltf"],scale:1,position:[0,-.5,0]},"dual shock 4":{folder:"game_controller-_version_1",files:["scene.gltf"],scale:1,position:[0,-.5,0]},"sony playstation 4":{folder:"ps4",files:["scene.gltf"],scale:1,position:[0,-.5,0]},"playstation 4":{folder:"ps4",files:["scene.gltf"],scale:1,position:[0,-.5,0]},ps4:{folder:"ps4",files:["scene.gltf"],scale:1,position:[0,-.5,0]},"gaming pc":{folder:"gaming-pc-with-animated-textures-that-wont-work",files:["source/model.gltf"],scale:1,position:[0,-1,0]}},this.searchAliases={macbook:["macbook pro","macbook air","mac book"],iphone:["apple iphone","iphone pro","iphone max"],samsung:["galaxy","samsung galaxy"],asus:["asus tuf","asus rog","tuf gaming"],hp:["hewlett packard","hp laptop"],lenovo:["thinkpad","ideapad"],acer:["acer laptop","nitro"],xiaomi:["redmi","mi"],gaming:["gaming laptop","gaming pc","gaming computer"]}}getModelConfig(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const t=[e,"".concat(i," ").concat(o),"".concat(i," ").concat(e),o].filter(Boolean);for(const n of t){const e=this.normalizeSearchTerm(n);if(this.modelMappings[e])return this.modelMappings[e];const i=this.findFuzzyMatch(e);if(i)return i}return null}normalizeSearchTerm(e){return e.toLowerCase().replace(/[^\w\s]/g,"").replace(/\s+/g," ").trim()}findFuzzyMatch(e){const i=e.split(" "),o=["macbook","iphone","apple","samsung","galaxy","asus","hp","lenovo","legion","acer","xiaomi","redmi","vivo","gaming"].filter(e=>i.includes(e)),t=Object.entries(this.modelMappings).filter(e=>{let[i]=e;if(0===o.length)return!0;const t=i.split(" ");return o.some(e=>t.includes(e))});for(const[n,l]of t){const e=n.split(" ");if(i.filter(i=>e.some(e=>e.includes(i)||i.includes(e))).length>=.7*Math.min(i.length,e.length))return l}return null}getModelPaths(e){if(!e)return[];const i="https://www.sparkle-pro.co.uk/api/models".replace(/\/$/,""),o="".concat(i,"/").concat(e.folder),t=[];for(let n of e.files){const e=String(n).trim().replace(/(\.gltf|\.glb|\.obj)\.+$/i,"$1");if(e.endsWith(".glb"))t.push("".concat(o,"/").concat(e));else if(e.endsWith(".gltf"))t.push("".concat(o,"/").concat(e));else if(e.endsWith(".obj"))t.push("".concat(o,"/").concat(e));else if(e.endsWith(".zip")||e.endsWith(".7z")||e.endsWith(".fbx")){const i=e.replace(/\.(zip|7z|fbx)$/i,".glb");t.push("".concat(o,"/").concat(i));const n=e.replace(/\.(zip|7z|fbx)$/i,".gltf");t.push("".concat(o,"/").concat(n))}}return t.push("".concat(o,"/scene.glb"),"".concat(o,"/model.glb"),"".concat(o,"/source/scene.glb"),"".concat(o,"/source/model.glb")),t.push("".concat(o,"/scene.gltf"),"".concat(o,"/model.gltf"),"".concat(o,"/source/scene.gltf"),"".concat(o,"/source/model.gltf")),[...new Set(t)]}async checkModelExists(e){try{if(!e.endsWith(".gltf")&&!e.endsWith(".glb")&&!e.endsWith(".obj"))return!1;let t;try{let o=e;try{const i=new URL(e);if(/sparkle-pro\.co\.uk$/i.test(i.hostname)){const e=i.pathname+(i.search||""),t=decodeURIComponent(e).replace(/(\.gltf|\.glb|\.obj)\.+$/i,"$1");o="https://".concat(i.host,"/api/models-proxy?url=").concat(encodeURIComponent(t))}}catch(i){}t=await fetch(o,{method:"HEAD",mode:"cors",cache:"no-store"})}catch(o){return!1}if(!t.ok)return!1;const n=t.headers.get("content-type");return!n||!n.includes("text/html")}catch(t){return!1}}validateModelConfig(e){if(!e||!e.folder||!e.files)return!1;return!!e.files.some(e=>e.endsWith(".gltf")||e.endsWith(".glb")||e.endsWith(".obj"))||(console.warn("No valid GLTF/GLB files in model config:",e),!1)}async getBestModelPath(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";try{const t=this.getModelConfig(e,i,o);if(!t)return console.log("No model configuration found for: ".concat(e)),null;if(!this.validateModelConfig(t))return console.warn("Invalid model configuration for: ".concat(e)),null;if(t.needsConversion)return console.log('Model for "'.concat(e,'" needs conversion from FBX/ZIP/7z to GLTF format. Falling back to 2D image.')),null;const n=this.getModelPaths(t).filter(e=>e.endsWith(".gltf")||e.endsWith(".glb")||e.endsWith(".obj"));if(0===n.length)return console.warn("No valid GLTF/GLB files found for: ".concat(e)),null;for(const i of n){if(await this.checkModelExists(i))return console.log('Found valid 3D model for "'.concat(e,'": ').concat(i)),{path:i,config:t,scale:t.scale||1,position:t.position||[0,0,0],rotation:t.rotation||[0,0,0]}}return console.warn("No accessible 3D model files found for: ".concat(e)),null}catch(t){return console.error('Error getting model path for "'.concat(e,'":'),t),null}}getAvailableModels(){return Object.keys(this.modelMappings)}searchModels(e){const i=this.normalizeSearchTerm(e).split(" ");return Object.keys(this.modelMappings).filter(e=>{const o=this.normalizeSearchTerm(e);return i.some(e=>o.includes(e))})}updateMappingsFromDatabase(e){e.forEach(e=>{if(e.has_3d_model&&e.model3d_path){const i=this.normalizeSearchTerm(e.name);if(this.modelMappings[i]={folder:e.model3d_path,files:Array.isArray(e.model3d_files)?e.model3d_files:["scene.gltf"],scale:e.model3d_scale||1,position:Array.isArray(e.model3d_position)?e.model3d_position:[0,0,0],rotation:Array.isArray(e.model3d_rotation)?e.model3d_rotation:[0,0,0],config:e.model3d_config||{}},e.brand&&e.model){const o=this.normalizeSearchTerm("".concat(e.brand," ").concat(e.model));this.modelMappings[o]=this.modelMappings[i]}}})}getModelConfigFromGadget(e){return e&&e.has_3d_model&&e.model3d_path?{folder:e.model3d_path,files:Array.isArray(e.model3d_files)?e.model3d_files:["scene.gltf"],scale:e.model3d_scale||1,position:Array.isArray(e.model3d_position)?e.model3d_position:[0,0,0],rotation:Array.isArray(e.model3d_rotation)?e.model3d_rotation:[0,0,0],config:e.model3d_config||{}}:null}hasModel(e){return e&&e.has_3d_model&&e.model3d_path}},n=t},96382(e,i,o){o.r(i),o.d(i,{default:()=>oe});var t=o(89379),n=o(9950),l=o(38006),s=o(92994),r=o(19181),a=o(68484),c=o(79482),d=o(96469),u=o(6503),p=o(86057),f=o(27321),g=o(87209),h=o(65812),m=o(85935),x=o(56690),v=o(82024),b=o(55948),y=o(24514),_=o(38796),j=o(98519),A=o(4143),w=o(9940),k=o(79697),S=o(16253),M=o(82503),N=o(66615),C=o(80218),I=o(6732),O=o(65250),G=o(47371),P=o(4159),F=o.n(P),W=o(43405),D=o(31810),B=o(44414);const z=e=>{var i,o;let{gadgetId:l,gadgetName:a,onBookingComplete:c}=e;const[d,v]=(0,n.useState)(F()().add(1,"day").format("YYYY-MM-DD")),[b,y]=(0,n.useState)(""),[P,z]=(0,n.useState)([]),[E,T]=(0,n.useState)(!1),[Y,L]=(0,n.useState)(!1),[R,U]=(0,n.useState)(!1),[q,Q]=(0,n.useState)(null),[$,H]=(0,n.useState)(!1),[V,Z]=(0,n.useState)((null===(i=D.j[0])||void 0===i?void 0:i.id)||""),[K,X]=(0,n.useState)(0),[J,ee]=(0,n.useState)(!1),{isAuthenticated:ie,user:oe}=(0,W.A)(),te=d;(0,n.useEffect)(()=>{ie&&null!==oe&&void 0!==oe&&oe.id&&ne()},[ie,null===oe||void 0===oe?void 0:oe.id]);const ne=async()=>{try{const e=await r.lW.getUserActive(null===oe||void 0===oe?void 0:oe.id);null!==e&&void 0!==e&&e.success&&(ee(e.hasActive),e.hasActive&&Q("You already have an active appointment. Please complete or cancel it first."))}catch(e){console.error("Error checking active appointments:",e)}};(0,n.useEffect)(()=>{if(!d||!V)return;(async()=>{U(!0),Q(null);try{const e=await r.lW.getAvailableSlots(d,V);if(null!==e&&void 0!==e&&e.success){const i=e.slots||[];z(i);0===F()(d).day()?Q("Appointments are not available on Sundays. Please select a different date."):0===i.length&&Q("No available slots for this date. Please choose another date.")}else Q((null===e||void 0===e?void 0:e.message)||"Failed to load available time slots");y("")}catch(e){console.error("Error fetching available slots:",e),Q("Failed to load available time slots. Please try again.")}finally{U(!1)}})()},[d,V]);const le=F()().add(1,"day").format("YYYY-MM-DD"),se=F()().add(90,"day").format("YYYY-MM-DD"),re=F()(d),ae=0===re.day();return(0,B.jsxs)(_.A,{elevation:3,sx:{p:3,mb:4,borderRadius:2,background:"linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)"},children:[(0,B.jsx)(j.A,{variant:"h5",component:"h2",gutterBottom:!0,sx:{fontWeight:"bold",color:"#333",display:"flex",alignItems:"center",gap:1},children:"\ud83d\udcc5 Schedule a Viewing"}),(0,B.jsxs)(j.A,{variant:"body2",sx:{mb:2,color:"#666"},children:["Book an appointment to view the ",(0,B.jsx)("strong",{children:a})," in person at our mobile van."]}),J&&(0,B.jsx)(p.A,{severity:"warning",sx:{mb:2},children:"You have an active appointment. Complete or cancel it before booking another viewing."}),q&&(0,B.jsx)(p.A,{severity:"error",sx:{mb:2},onClose:()=>Q(null),children:q}),$&&(0,B.jsx)(p.A,{severity:"success",sx:{mb:2},children:"\u2705 Your appointment has been booked successfully! Check your email for confirmation details."}),(0,B.jsxs)(A.A,{activeStep:K,sx:{mb:3},children:[(0,B.jsx)(w.A,{children:(0,B.jsx)(k.A,{children:"Select Date"})}),(0,B.jsx)(w.A,{children:(0,B.jsx)(k.A,{children:"Select Time"})}),(0,B.jsx)(w.A,{children:(0,B.jsx)(k.A,{children:"Confirm"})})]}),(0,B.jsxs)(S.A,{container:!0,spacing:3,children:[(0,B.jsx)(S.A,{item:!0,xs:12,md:6,children:(0,B.jsxs)(f.A,{sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,B.jsx)(M.A,{label:"Select Date",type:"date",value:d,onChange:e=>{v(e.target.value),X(0)},inputProps:{min:le,max:se},fullWidth:!0,helperText:"Business hours: Monday-Saturday, 9 AM-5 PM",disabled:J}),(0,B.jsxs)(g.A,{fullWidth:!0,sx:{my:1},disabled:J,children:[(0,B.jsx)(h.A,{id:"location-label",children:"Meeting Location"}),(0,B.jsx)(m.A,{labelId:"location-label",id:"location-select",value:V,label:"Meeting Location",onChange:e=>{Z(e.target.value),y(""),X(0)},children:D.j.map(e=>(0,B.jsx)(x.A,{value:e.id,children:e.name},e.id))})]}),(0,B.jsxs)(j.A,{variant:"caption",sx:{color:"#666"},children:[(0,B.jsx)(s.N_,{to:"/find-us",style:{color:"#48CEDB",textDecoration:"none",fontWeight:"bold"},children:"\ud83d\udccd Find Us"})," for location details and directions."]})]})}),(0,B.jsx)(S.A,{item:!0,xs:12,md:6,children:(0,B.jsxs)(f.A,{sx:{display:"flex",flexDirection:"column",height:"100%",justifyContent:"center",gap:2},children:[(0,B.jsxs)(f.A,{children:[(0,B.jsx)(j.A,{variant:"h6",gutterBottom:!0,sx:{fontWeight:"bold"},children:re.format("dddd, MMMM D, YYYY")}),ae&&(0,B.jsx)(p.A,{severity:"info",sx:{mb:1},children:"\u26a0\ufe0f Appointments not available on Sundays"})]}),R?(0,B.jsx)(f.A,{sx:{display:"flex",justifyContent:"center",my:2},children:(0,B.jsx)(u.A,{size:24})}):!ae&&P.length>0?(0,B.jsxs)(B.Fragment,{children:[(0,B.jsxs)(g.A,{fullWidth:!0,sx:{my:1},disabled:J,children:[(0,B.jsx)(h.A,{id:"time-slot-label",children:"Select Time"}),(0,B.jsx)(m.A,{labelId:"time-slot-label",id:"time-slot-select",value:b,label:"Select Time",onChange:e=>{y(e.target.value),X(1)},children:P.map(e=>(0,B.jsx)(x.A,{value:e,children:F()("2000-01-01 ".concat(e)).format("h:mm A")},e))})]}),(0,B.jsx)(N.A,{variant:"contained",color:"success",fullWidth:!0,disabled:!b||Y||J,onClick:()=>{ie?J?Q("You already have an active appointment."):b?T(!0):Q("Please select a time slot"):Q("Please sign in to book an appointment")},sx:{mt:1,fontWeight:"bold"},children:Y?(0,B.jsx)(u.A,{size:20}):"\u2713 Book Appointment"})]}):!ae&&(0,B.jsx)(p.A,{severity:"info",sx:{my:2},children:"No available slots for this date. Please try another date."})]})})]}),(0,B.jsxs)(C.A,{open:E,onClose:()=>T(!1),maxWidth:"sm",fullWidth:!0,children:[(0,B.jsx)(I.A,{sx:{fontWeight:"bold",color:"#48CEDB"},children:"\u2713 Confirm Your Booking"}),(0,B.jsx)(O.A,{sx:{mt:1},children:(0,B.jsxs)(f.A,{sx:{display:"flex",flexDirection:"column",gap:1.5},children:[(0,B.jsxs)(f.A,{children:[(0,B.jsx)(j.A,{variant:"caption",sx:{color:"#666"},children:"Gadget"}),(0,B.jsx)(j.A,{variant:"body1",sx:{fontWeight:"bold"},children:a})]}),(0,B.jsxs)(f.A,{children:[(0,B.jsx)(j.A,{variant:"caption",sx:{color:"#666"},children:"Date & Time"}),(0,B.jsxs)(j.A,{variant:"body1",sx:{fontWeight:"bold"},children:[F()(d).format("dddd, MMMM D, YYYY")," at ",F()("2000-01-01 ".concat(b)).format("h:mm A")]})]}),(0,B.jsxs)(f.A,{children:[(0,B.jsx)(j.A,{variant:"caption",sx:{color:"#666"},children:"Location"}),(0,B.jsx)(j.A,{variant:"body1",sx:{fontWeight:"bold"},children:null===(o=D.j.find(e=>e.id===V))||void 0===o?void 0:o.name})]}),(0,B.jsx)(f.A,{sx:{background:"#f0f0f0",p:1.5,borderRadius:1,mt:1},children:(0,B.jsxs)(j.A,{variant:"caption",sx:{color:"#666"},children:["A confirmation email will be sent to ",(0,B.jsx)("strong",{children:null===oe||void 0===oe?void 0:oe.email})]})})]})}),(0,B.jsxs)(G.A,{children:[(0,B.jsx)(N.A,{onClick:()=>T(!1),color:"primary",children:"Cancel"}),(0,B.jsx)(N.A,{onClick:async()=>{L(!0),Q(null);try{var e;const i=(null===(e=D.j.find(e=>e.id===V))||void 0===e?void 0:e.name)||"",o={gadgetId:l,gadgetName:a,appointmentDate:te,appointmentTime:b,locationId:V,locationName:i,userId:null===oe||void 0===oe?void 0:oe.id,userName:(null===oe||void 0===oe?void 0:oe.displayName)||(null===oe||void 0===oe?void 0:oe.name)||(null===oe||void 0===oe?void 0:oe.email)||"Customer",userEmail:(null===oe||void 0===oe?void 0:oe.email)||""},n=await r.lW.create(o);if(null===n||void 0===n||!n.success)throw new Error((null===n||void 0===n?void 0:n.error)||"Failed to create appointment");H(!0),T(!1),Q(null),y(""),v(F()().add(1,"day").format("YYYY-MM-DD")),X(0),ee(!0),c&&c((0,t.A)((0,t.A)({},o),{},{appointmentId:n.appointmentId}))}catch(i){console.error("Error booking appointment:",i),Q(i.message||"Failed to book appointment. Please try again.")}finally{L(!1)}},color:"success",variant:"contained",disabled:Y,sx:{fontWeight:"bold"},children:Y?(0,B.jsx)(u.A,{size:20}):"Confirm Booking"})]})]})]})};o(19676);var E=o(69335),T=o(18069),Y=o(31949),L=o(15320),R=o(85105),U=o(17153),q=o(55884),Q=o(66424),$=o(72828),H=o(43963),V=o(16498),Z=o(13822),K=o(12930);const X=[{key:"like",label:"Like",icon:(0,B.jsx)(H.A,{fontSize:"small"})},{key:"dislike",label:"Dislike",icon:(0,B.jsx)(V.A,{fontSize:"small"})},{key:"emoji_heart",label:"Love",icon:(0,B.jsx)($.A,{fontSize:"small",color:"error"})},{key:"emoji_fire",label:"Fire",icon:(0,B.jsx)(Z.A,{fontSize:"small",color:"warning"})},{key:"emoji_smile",label:"Smile",icon:(0,B.jsx)(K.A,{fontSize:"small",color:"info"})}];function J(e){let{gadgetId:i}=e;const{isAuthenticated:o,user:l}=(0,W.A)(),a=(0,s.Zp)(),[c,d]=(0,n.useState)(!0),[u,p]=(0,n.useState)(null),[g,h]=(0,n.useState)(!1),[m,x]=(0,n.useState)([]),[v,b]=(0,n.useState)(null),[y,_]=(0,n.useState)(0),[A,w]=(0,n.useState)(""),[k,S]=(0,n.useState)(0),[C,I]=(0,n.useState)({}),[O,G]=(0,n.useState)({}),P=o&&k>0&&A.trim().length>0,F=async()=>{d(!0),p(null);try{const e=await r.QO.getReviews(i);if(null!==e&&void 0!==e&&e.success){const i=e.data||{},o=Array.isArray(i.reviews)?i.reviews:[];x(o);const t="undefined"!==typeof i.averageRating?i.averageRating:null,n="undefined"!==typeof i.count?i.count:void 0;if(null!==t&&"undefined"!==typeof n)b(t),_(Number(n)||0);else{const e=o.map(e=>Number(e.rating)).filter(e=>Number.isFinite(e)&&e>0),i=e.length,t=i>0?(e.reduce((e,i)=>e+i,0)/i).toFixed(1):null;b(t?Number(t):null),_(i)}}else p("Failed to load reviews")}catch(e){p("Failed to load reviews")}finally{d(!1)}};(0,n.useEffect)(()=>{i&&F()},[i]);const D=(0,n.useMemo)(()=>null===v?"No ratings yet":"".concat(v," out of 5 (").concat(y," rating").concat(1===y?"":"s",")"),[v,y]);return(0,B.jsxs)(f.A,{sx:{mt:4,color:"#fff","& .MuiTypography-root":{color:"#fff !important"}},children:[(0,B.jsx)(j.A,{variant:"h5",sx:{color:"#fff",mb:1},children:"Reviews & Ratings"}),(0,B.jsx)(j.A,{variant:"body2",sx:{color:"#fff",mb:2},children:D}),(0,B.jsxs)(f.A,{sx:{p:2,borderRadius:1,border:"1px solid rgba(255,255,255,0.12)"},children:[(0,B.jsx)(j.A,{variant:"subtitle1",sx:{color:"#fff",mb:1},children:"Add your review"}),(0,B.jsxs)(R.A,{direction:{xs:"column",sm:"row"},spacing:2,alignItems:{xs:"flex-start",sm:"center"},children:[(0,B.jsx)(U.A,{name:"gadget-rating",value:k,onChange:(e,i)=>S(i||0),size:"large",sx:{"& .MuiRating-iconFilled":{color:"#ffd700"},"& .MuiRating-iconHover":{color:"#ffeb3b"},"& .MuiRating-iconEmpty":{color:"rgba(255,255,255,0.35)"}}}),(0,B.jsx)(M.A,{value:A,onChange:e=>w(e.target.value),placeholder:o?"Share your thoughts...":"Sign in to write a review",fullWidth:!0,multiline:!0,minRows:2,disabled:!o||g,inputProps:{style:{color:"#000"}},sx:{flex:1,"& .MuiInputBase-root":{bgcolor:"#fff",color:"#000"},"& .MuiInputBase-root.Mui-disabled":{bgcolor:"#fff",opacity:1},"& .MuiInputBase-input::placeholder":{color:"#666",opacity:1},"& .MuiOutlinedInput-notchedOutline":{borderColor:"rgba(0,0,0,0.25)"},"& .MuiOutlinedInput-root:hover .MuiOutlinedInput-notchedOutline":{borderColor:"rgba(0,0,0,0.35)"},"& .MuiOutlinedInput-root.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"#48CEDB"}}}),(0,B.jsx)(N.A,{variant:"contained",onClick:async()=>{if(o){if(P){h(!0),p(null);try{await r.QO.createReview(i,{userUid:null===l||void 0===l?void 0:l.uid,comment:A.trim(),rating:k}),w(""),S(0),await F()}catch(n){var e,t;p((null===n||void 0===n||null===(e=n.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.error)||"Failed to post review")}finally{h(!1)}}}else a("/signin")},disabled:!P||g,sx:{bgcolor:"#48CEDB",color:"#fff","&:hover":{bgcolor:"#39B9C7"},"&.Mui-disabled":{bgcolor:"rgba(72,206,219,0.35)",color:"rgba(255,255,255,0.8)"}},children:g?"Posting...":"Post"})]}),u&&(0,B.jsx)(j.A,{variant:"caption",sx:{color:"#ffb4b4",mt:1,display:"block"},children:u})]}),(0,B.jsx)(q.A,{sx:{my:3,borderColor:"rgba(255,255,255,0.12)"}}),c?(0,B.jsx)(j.A,{variant:"body2",sx:{color:"#fff"},children:"Loading reviews..."}):0===m.length?(0,B.jsx)(j.A,{variant:"body2",sx:{color:"#fff"},children:"No reviews yet. Be the first to review."}):(0,B.jsx)(R.A,{spacing:2,children:m.map(e=>(0,B.jsxs)(f.A,{sx:{p:2,borderRadius:1,border:"1px solid rgba(255,255,255,0.12)"},children:[(0,B.jsxs)(R.A,{direction:"row",spacing:1,alignItems:"center",justifyContent:"space-between",children:[(0,B.jsx)(j.A,{variant:"subtitle2",sx:{color:"#fff"},children:e.userMasked}),(0,B.jsx)(j.A,{variant:"caption",sx:{color:"#fff"},children:new Date(e.createdAt).toLocaleString()})]}),(0,B.jsx)(R.A,{direction:"row",alignItems:"center",spacing:1,sx:{mt:.5},children:e.rating?(0,B.jsx)(U.A,{name:"r-".concat(e.id),value:e.rating,readOnly:!0,size:"small",sx:{"& .MuiRating-iconFilled":{color:"#ffd700"},"& .MuiRating-iconEmpty":{color:"rgba(255,255,255,0.35)"}}}):null}),(0,B.jsx)(j.A,{variant:"body2",sx:{color:"#fff",mt:1},children:e.comment}),(0,B.jsx)(R.A,{direction:"row",alignItems:"center",spacing:1,sx:{mt:1},children:X.map(i=>{const t="like"===i.key?e.likesCount||0:"dislike"===i.key?e.dislikesCount||0:(null===(n=e.reactions)||void 0===n?void 0:n[i.key])||0;var n;return(0,B.jsxs)(R.A,{direction:"row",spacing:.5,alignItems:"center",children:[(0,B.jsx)(Q.A,{size:"small",onClick:()=>(async(e,i)=>{if(o)try{await r.QO.reactToReview(e,{userUid:null===l||void 0===l?void 0:l.uid,reaction:i}),await F()}catch(t){}else a("/signin")})(e.id,i.key),sx:{color:"#fff"},children:i.icon}),(0,B.jsx)(j.A,{variant:"caption",sx:{color:"#fff"},children:t})]},i.key)})}),Array.isArray(e.replies)&&e.replies.length>0&&(0,B.jsx)(f.A,{sx:{mt:1.5,pl:2,borderLeft:"2px solid rgba(255,255,255,0.1)"},children:e.replies.map(e=>(0,B.jsxs)(f.A,{sx:{mb:1},children:[(0,B.jsxs)(R.A,{direction:"row",spacing:1,alignItems:"center",justifyContent:"space-between",children:[(0,B.jsx)(j.A,{variant:"caption",sx:{color:"#fff"},children:e.userMasked}),(0,B.jsx)(j.A,{variant:"caption",sx:{color:"#fff"},children:new Date(e.createdAt).toLocaleString()})]}),(0,B.jsx)(j.A,{variant:"body2",sx:{color:"#fff"},children:e.comment})]},e.id))}),(0,B.jsxs)(R.A,{direction:{xs:"column",sm:"row"},spacing:1,alignItems:{xs:"stretch",sm:"center"},sx:{mt:1},children:[(0,B.jsx)(M.A,{value:C[e.id]||"",onChange:i=>I(o=>(0,t.A)((0,t.A)({},o),{},{[e.id]:i.target.value})),placeholder:o?"Write a reply...":"Sign in to reply",fullWidth:!0,size:"small",disabled:!o||!!O[e.id],inputProps:{style:{color:"#000"}},sx:{"& .MuiInputBase-root":{bgcolor:"#fff",color:"#000"},"& .MuiInputBase-root.Mui-disabled":{bgcolor:"#fff",opacity:1},"& .MuiInputBase-input::placeholder":{color:"#666",opacity:1},"& .MuiOutlinedInput-notchedOutline":{borderColor:"rgba(0,0,0,0.25)"},"& .MuiOutlinedInput-root:hover .MuiOutlinedInput-notchedOutline":{borderColor:"rgba(0,0,0,0.35)"},"& .MuiOutlinedInput-root.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"#48CEDB"}}}),(0,B.jsx)(N.A,{variant:"outlined",onClick:()=>(async e=>{if(!o)return void a("/signin");const i=(C[e]||"").trim();if(i){G(i=>(0,t.A)((0,t.A)({},i),{},{[e]:!0}));try{await r.QO.replyToReview(e,{userUid:null===l||void 0===l?void 0:l.uid,comment:i}),I(i=>(0,t.A)((0,t.A)({},i),{},{[e]:""})),await F()}catch(n){}finally{G(i=>(0,t.A)((0,t.A)({},i),{},{[e]:!1}))}}})(e.id),disabled:!o||""===(C[e.id]||"").trim()||!!O[e.id],sx:{color:"#48CEDB",borderColor:"#48CEDB","&:hover":{borderColor:"#39B9C7",bgcolor:"rgba(72,206,219,0.12)"},"&.Mui-disabled":{color:"rgba(72,206,219,0.5)",borderColor:"rgba(72,206,219,0.3)"}},children:O[e.id]?"Replying...":"Reply"})]})]},e.id))})]})}var ee=o(29040);const ie=n.lazy(()=>Promise.all([o.e(559),o.e(782),o.e(330)]).then(o.bind(o,35330))),oe=()=>{var e,i;const o=(0,s.Zp)(),[_]=(0,n.useState)("Gadgets"),[j,A]=(0,n.useState)(!1),{id:w,category:k,slug:S}=(0,s.g)(),M=S?(0,d.Ze)("/gadgets/".concat(k,"/").concat(S)):w,[N,C]=(0,n.useState)(null),[I,O]=(0,n.useState)(!0),[G,P]=(0,n.useState)(null),[F,D]=(0,n.useState)(0),[R,U]=(0,n.useState)("2d"),[q,Q]=(0,n.useState)(0),[$,H]=(0,n.useState)(!1),{isAuthenticated:V,user:Z}=(0,W.A)(),{addToCart:K}=(0,T._$)(),{formatLocalPrice:X,currency:oe,isInMalawi:te,loading:ne}=(0,E.e)(),[le,se]=(0,n.useState)(!1),[re,ae]=(0,n.useState)(""),[ce,de]=(0,n.useState)(!1),[ue,pe]=(0,n.useState)(!1),[fe,ge]=(0,n.useState)(!1),he=(0,n.useRef)(null),[me,xe]=(0,n.useState)([]),[ve,be]=(0,n.useState)([]),[ye,_e]=(0,n.useState)([]),[je,Ae]=(0,n.useState)([]),[we,ke]=(0,n.useState)(""),[Se,Me]=(0,n.useState)(""),[Ne,Ce]=(0,n.useState)("new"),[Ie,Oe]=(0,n.useState)(void 0),[Ge,Pe]=(0,n.useState)(0),[Fe,We]=(0,n.useState)(null),De={new:"New",like_new:"Like New",good:"Good",fair:"Fair"},Be={New:"new","Like New":"like_new",Good:"good",Fair:"fair"},ze=["new","like_new","good","fair"],Ee=!(null===N||void 0===N||!N.category)&&["smartphones","tablets","laptops","phones","mobile","iphone","samsung","ipad"].some(e=>N.category.toLowerCase().includes(e.toLowerCase())),Te=n.useMemo(()=>{if(0===me.length)return ye;const e=new Set;return me.forEach(i=>{var o;parseInt(null!==(o=i.stock_quantity)&&void 0!==o?o:0,10)>0&&e.add(i.storage)}),ye.filter(i=>e.has(i))},[me,ye]),Ye=n.useMemo(()=>{if(0===me.length)return je;const e=Se?me.filter(e=>e.storage===Se):me,i=new Set;return e.forEach(e=>{var o;parseInt(null!==(o=e.stock_quantity)&&void 0!==o?o:0,10)>0&&i.add(e.condition_status)}),je.filter(e=>{const o=Be[e];return i.has(o)})},[me,Se,je]),Le=(n.useMemo(()=>{var e;if(null!==Fe)return Fe>0;if(!Se)return!0;const i=me.find(e=>e.storage===Se&&e.condition_status===Ne);return!!i&&parseInt(null!==(e=i.stock_quantity)&&void 0!==e?e:0,10)>0},[me,Se,Ne,Fe]),e=>"string"===typeof e?parseFloat(e.replace(/[^0-9.-]+/g,""))||0:Number(e)||0),Re={hidden:{},show:{transition:{delayChildren:.12,staggerChildren:.08}}},Ue={hidden:{opacity:0,y:8},show:{opacity:1,y:0,transition:{duration:.35,ease:[.22,1,.36,1]}}},qe={hidden:{opacity:0,y:12,scale:.98},show:{opacity:1,y:0,scale:1,transition:{type:"spring",stiffness:240,damping:22}}};(0,n.useEffect)(()=>{w&&(async()=>{try{O(!0);const n=await r.QO.getById(w);if(n.success){const l=n.data;C(l);const s=Array.isArray(l.variants)?l.variants.map(e=>{var i;return(0,t.A)((0,t.A)({},e),{},{color:e.color||null,color_hex:e.color_hex||e.colorHex||null,condition_status:null!==(i=e.condition_status)&&void 0!==i?i:e.condition,stock_quantity:"undefined"!==typeof e.stock_quantity?e.stock_quantity:e.stockQuantity,is_active:"undefined"!==typeof e.is_active?e.is_active:e.active,price_gbp:e.price_gbp||e.priceGbp||null})}).filter(e=>{var i;return 1===(null!==(i=null===e||void 0===e?void 0:e.is_active)&&void 0!==i?i:1)&&"poor"!==String(e.condition_status)}):[];if(xe(s),s.length>0){var e,i;const o=new Map;s.forEach(e=>{e.color&&o.set(e.color,{color:e.color,colorHex:e.color_hex||null})});const t=Array.from(o.values());be(t);const n=Array.from(new Set(s.map(e=>String(e.storage)).filter(Boolean)));_e(n);const r=Array.from(new Set(s.map(e=>String(e.condition_status)).filter(Boolean))).filter(e=>ze.includes(e)),a=r.map(e=>De[e]).filter(Boolean);Ae(a);const c=t.length>0?t[0].color:"",d=n[0]||"",u=r.includes(String(l.condition||l.condition_status))?String(l.condition||l.condition_status):r[0]||"new";ke(c),Me(d),Ce(u);let p=null;c&&d&&(p=s.find(e=>String(e.color)===String(c)&&String(e.storage)===String(d)&&String(e.condition_status)===String(u))),!p&&d&&(p=s.find(e=>String(e.storage)===String(d)&&String(e.condition_status)===String(u))),p||(p=s.find(e=>String(e.condition_status)===String(u)));const f=Le(te?p?p.price_mwk||p.price:l.price_mwk||l.priceMwk||l.price:p?p.price_gbp||p.price:l.price_gbp||l.priceGbp||l.price/2358);Pe(f),Oe((null===(e=p)||void 0===e?void 0:e.id)||void 0);const g=p?Math.max(0,parseInt(null!==(i=p.stock_quantity)&&void 0!==i?i:0,10)||0):null;We(g)}else{be([]),_e([]),Ae([]),ke(""),Me(""),Ce(String(l.condition||l.condition_status||"new"));const e=te?l.price_mwk||l.priceMwk||l.price:l.price_gbp||l.priceGbp||l.price/2358;Pe(Le(e)),Oe(void 0),We(null)}try{const e=localStorage.getItem("xp_analytics_sid"),i=null===l||void 0===l?void 0:l.id;if(e&&i&&he.current!==i){const o={productId:i,name:null===l||void 0===l?void 0:l.name,brand:null===l||void 0===l?void 0:l.brand,model:null===l||void 0===l?void 0:l.model,category:null===l||void 0===l?void 0:l.category,price:Le(null===l||void 0===l?void 0:l.price),condition:String((null===l||void 0===l?void 0:l.condition)||(null===l||void 0===l?void 0:l.condition_status)||"")};await(0,ee.yM)(e,"view_product",o),he.current=i}}catch(o){}}else P("Gadget not found")}catch(n){console.error("Error fetching gadget:",n),P("Failed to load gadget details")}finally{O(!1)}})()},[M]);const[Qe,$e]=(0,n.useState)(null);if((0,n.useEffect)(()=>{if(!N)return;const e=(0,d.wV)(N.name,N.brand,N.category),i=(0,d.wJ)(N.name,N.brand,N.description,Ge),o=(0,d.j$)((0,t.A)((0,t.A)({},N),{},{price:Ge})),n=(0,d.KQ)("/gadgets/".concat(N.id));$e({title:e,description:i,canonical:n,ogImage:N.image,structuredData:o}),document.title=e},[N,w]),I)return(0,B.jsx)("div",{className:"deep bg-primary w-full overflow-hidden min-h-screen flex items-center justify-center",children:(0,B.jsxs)("div",{className:"flex flex-col items-center",children:[(0,B.jsx)(u.A,{sx:{color:"white",mb:2},size:60}),(0,B.jsx)("div",{className:"text-white text-xl",children:"Loading gadget details..."})]})});if(G||!N)return(0,B.jsx)("div",{className:"deep bg-primary w-full overflow-hidden min-h-screen flex items-center justify-center",children:(0,B.jsxs)("div",{className:"flex flex-col items-center",children:[(0,B.jsx)(p.A,{severity:"error",sx:{mb:2},children:G||"Gadget not found"}),(0,B.jsx)(s.N_,{to:"/gadgets",className:"text-lg text-blue-400 hover:underline",onClick:e=>{e.preventDefault(),o("/gadgets")},children:"\u2190 Return to Gadgets"})]})});const He=()=>{const e=e=>{if(null===e||void 0===e)return null;if("number"===typeof e&&Number.isFinite(e))return e;if("string"===typeof e){const i=e.match(/-?\d+/);if(i){const e=parseInt(i[0],10);return Number.isFinite(e)?e:null}return null}return null},i=[null===N||void 0===N?void 0:N.stock_quantity,null===N||void 0===N?void 0:N.stockQuantity,null===N||void 0===N?void 0:N.stock];let o=null;for(const a of i){const i=e(a);if(null!==i){o=i;break}}null===o&&(o="undefined"!==typeof(null===N||void 0===N?void 0:N.in_stock)?N.in_stock?1:0:"undefined"!==typeof(null===N||void 0===N?void 0:N.inStock)&&N.inStock?1:0);const t=o;if(!(t>0))return void alert("This item is currently out of stock.");const n=Se||void 0,l=Ge||Le(N.price),s=Ne||N.condition||N.condition_status||"new",r=null!==Fe&&void 0!==Fe?Fe:t;K({id:N.id,title:N.name,price:l,image:N.image,number:r,brand:N.brand||"",condition:s,storage:n,color:we||void 0,variantId:Ie,description:N.description||"",specifications:N.specifications||null}),ae("Item added to cart!"),se(!0)},Ve=(e,i,o)=>{if(0===me.length)return null;if(e&&i){const t=me.find(t=>String(t.color)===String(e)&&String(t.storage)===String(i)&&String(t.condition_status)===String(o));if(t)return t}if(i){const e=me.find(e=>String(e.storage)===String(i)&&String(e.condition_status)===String(o));if(e)return e}if(e){const i=me.find(i=>String(i.color)===String(e)&&String(i.condition_status)===String(o));if(i)return i}return me.find(e=>String(e.condition_status)===String(o))},Ze=e=>{var i;const o=Le(te?e?e.price_mwk||e.price:N.price_mwk||N.priceMwk||N.price:e?e.price_gbp||e.price:N.price_gbp||N.priceGbp||N.price);Pe(o),Oe((null===e||void 0===e?void 0:e.id)||void 0);const t=e?Math.max(0,parseInt(null!==(i=e.stock_quantity)&&void 0!==i?i:0,10)||0):null;We(t)};return(0,B.jsxs)(B.Fragment,{children:[Qe&&(0,B.jsx)(c.A,(0,t.A)({},Qe)),(0,B.jsx)(l.P.div,{className:"deep bg-primary w-full min-h-screen overflow-hidden",initial:{opacity:0,scale:.98},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.98},transition:{duration:.35,ease:[.22,1,.36,1]},children:(0,B.jsx)("div",{className:"".concat(a.A.paddingX," ").concat(a.A.flexCenter),children:(0,B.jsxs)("div",{className:"".concat(a.A.boxWidth),children:[(0,B.jsxs)("section",{className:"flex flex-col items-center text-center p-6 sm:p-12 gap-8",children:[(0,B.jsx)("h1",{className:"text-white text-3xl sm:text-4xl md:text-5xl mb-4",children:N.name}),(0,B.jsx)(s.N_,{to:"/gadgets",className:"text-lg text-blue-400 hover:underline mb-4",onClick:e=>{e.preventDefault(),o("/gadgets")},children:"\u2190 Return to Gadgets"}),(0,B.jsx)("div",{className:"w-[95%] sm:w-[90%] md:w-[92%] lg:w-[90%] xl:w-[85%] max-w-6xl mx-auto",children:(0,B.jsxs)(l.P.div,{className:"grid grid-cols-1 md:grid-cols-2 gap-6 items-start",variants:{hidden:{},show:{transition:{staggerChildren:.08,when:"beforeChildren"}}},initial:"hidden",animate:"show",children:[(0,B.jsxs)(l.P.div,{className:"rounded-lg overflow-hidden shadow-lg",variants:{hidden:{opacity:0,x:-32,y:8,scale:.98},show:{opacity:1,x:0,y:0,scale:1,transition:{duration:.5,ease:[.22,1,.36,1]}}},children:[(0,B.jsx)("div",{className:"flex justify-center mb-4",children:(0,B.jsxs)("div",{className:"bg-gray-800 rounded-lg p-1 flex",children:[(0,B.jsx)("button",{onClick:()=>U("2d"),className:"px-4 py-2 rounded-md transition ".concat("2d"===R?"bg-blue-700 text-white":"text-gray-300 hover:text-white"),children:"Normal View"}),(0,B.jsx)("button",{onClick:async()=>{if(N){de(!0);try{const e=await Y.A.getBestModelPath(null===N||void 0===N?void 0:N.name,null===N||void 0===N?void 0:N.brand,null===N||void 0===N?void 0:N.model);e&&e.path?(pe(!1),U("3d")):(pe(!0),U("missing"))}catch(e){pe(!0),U("missing")}finally{de(!1)}}},className:"px-4 py-2 rounded-md transition ".concat("3d"===R?"bg-blue-700 text-white":"text-gray-300 hover:text-white"," ").concat(ce?"opacity-50 cursor-wait":""," ").concat(Y.A.hasModel(N)||Y.A.getModelConfig(null===N||void 0===N?void 0:N.name,null===N||void 0===N?void 0:N.brand,null===N||void 0===N?void 0:N.model)?"":"opacity-50 cursor-not-allowed"),"aria-disabled":ce||!(Y.A.hasModel(N)||Y.A.getModelConfig(null===N||void 0===N?void 0:N.name,null===N||void 0===N?void 0:N.brand,null===N||void 0===N?void 0:N.model)),children:"Detailed View"})]})}),"3d"===R&&(0,B.jsx)("div",{className:"text-gray-400 text-sm text-center mb-4",role:"status","aria-live":"polite",children:"Note: This 3D model is licensed and sourced from Sketchfab. It\u2019s provided for visual reference only and may not perfectly represent the actual product."}),"missing"===R?(0,B.jsx)("div",{className:"h-[400px] flex items-center justify-center rounded-lg bg-gray-800 text-gray-200 shadow-lg",children:"Sorry , Detailed View is not available for this Gadget"}):"2d"===R?(0,B.jsx)(l.P.img,{src:N.more_img&&N.more_img[F]||N.image,alt:"".concat(N.name," view ").concat(F+1),className:"w-full h-auto rounded-lg shadow-lg",layoutId:"gadget-media-".concat(N.id),initial:{scale:1},animate:{scale:1},transition:{duration:.3}}):(0,B.jsx)(l.P.div,{className:"h-[700px] md:h-[800px] rounded-lg overflow-hidden shadow-lg",layoutId:"gadget-media-".concat(N.id),children:(0,B.jsx)(n.Suspense,{fallback:(0,B.jsx)("div",{className:"flex items-center justify-center w-full h-full text-gray-300",children:"Loading 3D view\u2026"}),children:(0,B.jsx)(ie,{gadgetName:N.name,gadgetBrand:N.brand,gadgetModel:N.model,fallbackImage:N.image,className:"w-full h-full",onModelError:()=>{pe(!0),U("missing")}})})}),"2d"===R&&N.more_img&&N.more_img.length>1&&(0,B.jsxs)("div",{className:"flex flex-col sm:flex-row justify-center items-center gap-4 mt-4",children:[(0,B.jsx)("button",{onClick:()=>{const e=N.more_img||[N.image];D(i=>(i-1+e.length)%e.length)},className:"px-6 py-2 rounded bg-blue-700 text-white hover:bg-black transition shadow-lg",children:"Prev"}),(0,B.jsx)("button",{onClick:()=>{const e=N.more_img||[N.image];D(i=>(i+1)%e.length)},className:"px-6 py-2 rounded bg-blue-700 text-white hover:bg-black transition shadow-lg",children:"Next"})]})]}),(0,B.jsxs)(l.P.div,{className:"bg-gray-900 rounded-xl p-6 shadow-xl text-left md:sticky md:top-24",variants:{hidden:{opacity:0,x:32,y:8,scale:.98},show:{opacity:1,x:0,y:0,scale:1,transition:{duration:.5,ease:[.22,1,.36,1],delay:.04}}},children:[(0,B.jsxs)(l.P.div,{className:"flex flex-col gap-4",variants:Re,children:[(0,B.jsxs)(l.P.p,{className:"text-gray-400",variants:Ue,children:["Brand: ",(0,B.jsx)("span",{className:"text-white",children:N.brand})]}),(0,B.jsxs)(l.P.p,{className:"text-gray-400",variants:Ue,children:["Model: ",(0,B.jsx)("span",{className:"text-white",children:N.model})]}),(0,B.jsxs)(l.P.p,{className:"text-gray-400",variants:Ue,children:["Category: ",(0,B.jsx)("span",{className:"text-white",children:N.category})]}),(ve.length>0||Ee&&0===me.length)&&(0,B.jsx)(f.A,{sx:{mt:1},children:(0,B.jsxs)(g.A,{size:"small",sx:{minWidth:160},children:[(0,B.jsx)(h.A,{sx:{color:0===ve.length?"rgba(255,255,255,0.5)":"white"},children:"Color"}),(0,B.jsx)(m.A,{value:ve.length>0&&(we||(null===(e=ve[0])||void 0===e?void 0:e.color))||"",label:"Color",onChange:e=>(e=>{if(ke(e),0===me.length){Oe(void 0),We(null);const e=Le(te?N.price_mwk||N.priceMwk||N.price:N.price_gbp||N.priceGbp||N.price);return void Pe(e)}const i=Ve(e,Se,Ne);Ze(i)})(e.target.value),disabled:ve.length<=1,displayEmpty:!0,sx:{color:0===ve.length?"rgba(255,255,255,0.5)":"white","& .MuiOutlinedInput-notchedOutline":{borderColor:"rgba(255, 255, 255, 0.2)"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"rgba(255, 255, 255, 0.3)"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"white"},"&.Mui-disabled":{color:"rgba(255,255,255,0.5)","& .MuiOutlinedInput-notchedOutline":{borderColor:"rgba(255, 255, 255, 0.15)"}}},MenuProps:{PaperProps:{sx:{bgcolor:"#1565c0",color:"white"}}},children:0===ve.length?(0,B.jsx)(x.A,{value:"",disabled:!0,children:"Not specified"}):ve.map(e=>(0,B.jsx)(x.A,{value:e.color,children:(0,B.jsxs)(f.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.colorHex&&(0,B.jsx)(f.A,{sx:{width:16,height:16,borderRadius:"50%",backgroundColor:e.colorHex,border:"1px solid rgba(255,255,255,0.3)"}}),e.color]})},e.color))})]})}),(je.length>0||Ee&&0===me.length)&&(0,B.jsx)(f.A,{sx:{mt:1},children:(0,B.jsxs)(g.A,{size:"small",sx:{minWidth:160},children:[(0,B.jsx)(h.A,{sx:{color:0===je.length?"rgba(255,255,255,0.5)":"white"},children:"Condition"}),(0,B.jsx)(m.A,{value:je.length>0&&De[Ne]||"New",label:"Condition",onChange:e=>(e=>{const i=Be[e]||e;if(Ce(i),0===me.length){Oe(void 0),We(null);const e=Le(te?N.price_mwk||N.priceMwk||N.price:N.price_gbp||N.priceGbp||N.price);return void Pe(e)}const o=Ve(we,Se,i);Ze(o)})(e.target.value),disabled:je.length<=1,sx:{color:0===je.length?"rgba(255,255,255,0.5)":"white","& .MuiOutlinedInput-notchedOutline":{borderColor:"rgba(255, 255, 255, 0.2)"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"rgba(255, 255, 255, 0.3)"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"white"},"&.Mui-disabled":{color:"rgba(255,255,255,0.5)","& .MuiOutlinedInput-notchedOutline":{borderColor:"rgba(255, 255, 255, 0.15)"}}},MenuProps:{PaperProps:{sx:{bgcolor:"#1565c0",color:"white"}}},children:0===Ye.length?(0,B.jsx)(x.A,{value:"New",disabled:!0,children:"New"}):Ye.map(e=>{const i=Be[e],o=me.some(e=>{var o;return e.condition_status===i&&(!Se||e.storage===Se)&&parseInt(null!==(o=e.stock_quantity)&&void 0!==o?o:0,10)>0});return(0,B.jsx)(x.A,{value:e,sx:{opacity:o?1:.5,"&::after":o?{}:{content:'" (Out of stock)"',fontSize:"0.75rem",ml:1,color:"rgba(255,255,255,0.5)"}},children:e},e)})})]})}),(Te.length>0||ye.length>0||Ee&&0===me.length)&&(0,B.jsx)(f.A,{sx:{mt:1},children:(0,B.jsxs)(g.A,{size:"small",sx:{minWidth:160},children:[(0,B.jsx)(h.A,{sx:{color:0===Te.length?"rgba(255,255,255,0.5)":"white"},children:"Storage"}),(0,B.jsx)(m.A,{value:Te.length>0?Se||Te[0]:ye.length>0?ye[0]:"",label:"Storage",onChange:e=>(e=>{if(Me(e),0===me.length){Oe(void 0),We(null);const e=Le(te?N.price_mwk||N.priceMwk||N.price:N.price_gbp||N.priceGbp||N.price);return void Pe(e)}const i=me.filter(i=>i.storage===e),o=i.some(e=>{var i;return e.condition_status===Ne&&parseInt(null!==(i=e.stock_quantity)&&void 0!==i?i:0,10)>0});let t=Ne;if(!o&&i.length>0){const e=i.find(e=>{var i;return parseInt(null!==(i=e.stock_quantity)&&void 0!==i?i:0,10)>0});e&&(t=e.condition_status,Ce(t))}const n=Ve(we,e,t);Ze(n)})(e.target.value),disabled:Te.length<=1&&ye.length<=1,displayEmpty:!0,sx:{color:0===Te.length?"rgba(255,255,255,0.5)":"white","& .MuiOutlinedInput-notchedOutline":{borderColor:"rgba(255, 255, 255, 0.2)"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"rgba(255, 255, 255, 0.3)"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"white"},"&.Mui-disabled":{color:"rgba(255,255,255,0.5)","& .MuiOutlinedInput-notchedOutline":{borderColor:"rgba(255, 255, 255, 0.15)"}}},MenuProps:{PaperProps:{sx:{bgcolor:"#1565c0",color:"white"}}},children:0===ye.length?(0,B.jsx)(x.A,{value:"",disabled:!0,children:"Not specified"}):ye.map(e=>{const i=me.some(i=>{var o;return i.storage===e&&parseInt(null!==(o=i.stock_quantity)&&void 0!==o?o:0,10)>0});return(0,B.jsxs)(x.A,{value:e,disabled:!i,sx:{opacity:i?1:.5},children:[e,i?"":" (Out of stock)"]},e)})})]})})]}),(()=>{const e=e=>{if(null===e||void 0===e)return null;if("number"===typeof e&&Number.isFinite(e))return e;if("string"===typeof e){const i=e.match(/-?\d+/);if(i){const e=parseInt(i[0],10);return Number.isFinite(e)?e:null}return null}return null},i=[null===N||void 0===N?void 0:N.stock_quantity,null===N||void 0===N?void 0:N.stockQuantity,null===N||void 0===N?void 0:N.stock];let o=null;for(const l of i){const i=e(l);if(null!==i){o=i;break}}null===o&&(o="undefined"!==typeof(null===N||void 0===N?void 0:N.in_stock)?N.in_stock?1:0:"undefined"!==typeof(null===N||void 0===N?void 0:N.inStock)&&N.inStock?1:0);const t=o>0,n=o<0,s=o>0;return(0,B.jsxs)(l.P.div,{className:"mt-4 flex flex-col gap-3",variants:Re,children:[!n&&(0,B.jsxs)(l.P.p,{className:"text-gray-400",variants:Ue,children:["Price:",(0,B.jsxs)("span",{className:"text-white text-2xl font-bold ml-2",children:["From ",(()=>{if(!t)return"Coming Soon";if(Ge){if(te){const e="string"===typeof Ge?parseFloat(Ge.replace(/[^0-9.]/g,"")):Number(Ge);if(Number.isFinite(e))return"MWK ".concat(Math.round(e).toLocaleString("en-US"))}return X(Ge)}const e=Le(te?N.price_mwk||N.priceMwk||N.price:N.price_gbp||N.priceGbp||N.price/2358);return te?"MWK ".concat(Math.round(e).toLocaleString("en-US")):X(e)})()]})]}),(0,B.jsxs)(l.P.p,{className:"text-gray-400",variants:Ue,children:["Stock:",(0,B.jsx)("span",{className:t?"text-green-500 ml-2":"text-yellow-400 ml-2",children:(null!==Fe&&void 0!==Fe?Fe:o)>0?"In Stock":"Coming Soon"})]}),s&&(0,B.jsx)(l.P.button,{variants:qe,whileHover:{scale:1.03},whileTap:{scale:.98},onClick:He,className:"px-6 py-3 rounded-lg text-white font-bold shadow-lg transition bg-blue-700 hover:bg-blue-800",children:"Add to Cart"}),s&&(0,B.jsx)(l.P.button,{variants:qe,whileHover:{scale:1.03},whileTap:{scale:.98},onClick:()=>ge(!0),className:"px-6 py-3 rounded-lg text-white font-bold shadow-lg transition bg-blue-700 hover:bg-blue-800",children:"Pay in installments"})]})})()]})]})}),(0,B.jsxs)(f.A,{sx:{width:"100%",maxWidth:"4xl",mb:4},children:[(0,B.jsx)(f.A,{sx:{borderBottom:1,borderColor:"divider"},children:(0,B.jsxs)(v.A,{value:q,onChange:(e,i)=>Q(i),variant:"fullWidth",sx:{"& .MuiTab-root":{color:"rgba(255,255,255,0.7)"},"& .Mui-selected":{color:"white"},"& .MuiTabs-indicator":{backgroundColor:"#3f51b5"}},children:[(0,B.jsx)(b.A,{label:"Product Details"}),(0,B.jsx)(b.A,{label:"Schedule Viewing",disabled:0===(()=>{if(!N)return 0;const e=e=>{if(null===e||void 0===e)return null;if("number"===typeof e&&Number.isFinite(e))return e;if("string"===typeof e){const i=e.match(/-?\d+/);if(i){const e=parseInt(i[0],10);return Number.isFinite(e)?e:null}return null}return null},i=[null===N||void 0===N?void 0:N.stock_quantity,null===N||void 0===N?void 0:N.stockQuantity,null===N||void 0===N?void 0:N.stock];let o=null;for(const t of i){const i=e(t);if(null!==i){o=i;break}}return null===o&&(o="undefined"!==typeof(null===N||void 0===N?void 0:N.in_stock)?N.in_stock?1:0:"undefined"!==typeof(null===N||void 0===N?void 0:N.inStock)&&N.inStock?1:0),Math.max(0,o)})()})]})}),(0,B.jsx)("div",{role:"tabpanel",hidden:0!==q,children:0===q&&(0,B.jsxs)(B.Fragment,{children:[(0,B.jsxs)("div",{className:"w-full max-w-4xl mt-4 mx-auto",children:[(0,B.jsxs)("div",{className:"text-left",children:[(0,B.jsx)("h2",{className:"text-white text-xl mb-4",children:"Description"}),(0,B.jsx)("p",{className:"text-gray-300",children:N.description})]}),N.specifications&&(0,B.jsxs)("div",{className:"mt-8 text-left",children:[(0,B.jsx)("h2",{className:"text-white text-xl mb-4",children:"Specifications"}),(0,B.jsx)("div",{className:"text-gray-300 grid grid-cols-1 md:grid-cols-2 gap-2",children:Object.entries(N.specifications).map(e=>{let[i,o]=e,t="";try{t=null===o||void 0===o?"N/A":Array.isArray(o)?o.join(", "):"object"===typeof o?Object.entries(o).map(e=>{let[i,o]=e;return"".concat(i,": ").concat(o)}).join(", "):String(o)}catch(G){console.warn("Error processing specification:",i,o,G),t="Unable to display"}return(0,B.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,B.jsxs)("span",{className:"font-medium capitalize",children:[i.replace(/([A-Z])/g," $1"),":"]}),(0,B.jsx)("span",{className:"text-right max-w-md",children:t})]},i)})})]})]}),(0,B.jsx)("div",{className:"mt-10 w-full mx-auto",children:(0,B.jsx)(J,{gadgetId:N.id})})]})}),(0,B.jsx)("div",{role:"tabpanel",hidden:1!==q,children:1===q&&(0,B.jsx)("div",{className:"mt-4",children:N&&(0,B.jsx)(B.Fragment,{children:V?(0,B.jsx)(B.Fragment,{children:((e,i,o)=>{const t=Math.max(0,parseInt(null!==(e=null!==(i=null!==(o=null===N||void 0===N?void 0:N.stock_quantity)&&void 0!==o?o:null===N||void 0===N?void 0:N.stockQuantity)&&void 0!==i?i:null===N||void 0===N?void 0:N.stock)&&void 0!==e?e:0,10)||0);return(0,B.jsx)(B.Fragment,{children:t>0?(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(p.A,{severity:"success",sx:{mb:2},children:"\u2713 Item in stock - You can schedule a viewing appointment to see it in person at our mobile van!"}),(0,B.jsx)(z,{gadgetId:N.id,gadgetName:N.name,onBookingComplete:e=>{H(!0),ae("\u2713 Appointment booked! Confirmation sent to ".concat(e.userEmail)),se(!0)}})]}):(0,B.jsx)(p.A,{severity:"warning",sx:{mb:2},children:"\u274c This item is currently out of stock and cannot be scheduled for viewing. Please check back soon or subscribe to notifications."})})})()}):(0,B.jsxs)(p.A,{severity:"info",sx:{mb:2},children:["\u2139\ufe0f Please sign in to schedule a viewing appointment. ",(0,B.jsx)(s.N_,{to:"/signin",className:"text-blue-400 hover:underline",children:"Sign in here"})]})})})})]})]}),N&&(0,B.jsx)(L.A,{open:fe,onClose:()=>ge(!1),item:{id:N.id,name:N.name,price:Ge||Le(N.price_gbp||N.priceGbp||N.price/2358),priceGbp:Ge||Le(N.price_gbp||N.priceGbp||N.price/2358),image:N.image,condition:Ne||N.condition||N.condition_status||"new",storage:Se||void 0,variantId:Ie,description:N.description||"",specifications:N.specifications||null},customerEmail:null!==(i=null===Z||void 0===Z?void 0:Z.email)&&void 0!==i?i:null}),(0,B.jsx)(y.A,{open:le,autoHideDuration:3e3,onClose:()=>se(!1),children:(0,B.jsx)(p.A,{onClose:()=>se(!1),severity:"success",children:re})})]})})})]})}}}]);